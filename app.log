2025-08-03 16:33:45.425 | INFO     | model_service:load_model:16 - Checking model exisgs
2025-08-03 16:33:45.427 | INFO     | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 16:33:45.427 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 16:33:45.428 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 16:33:45.428 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 16:33:45.433 | ERROR    | model:build_model:13 - An error has been caught in function 'build_model', process 'MainProcess' (854), thread 'MainThread' (8404344960):
Traceback (most recent call last):

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x15f59cf40>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x15f31b230>
    └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x102cdfbc0>

sqlite3.OperationalError: no such column: rent_apartments.construction_year


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 15, in <module>
    main()
    └ <function main at 0x102cc32e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x168480d60>
    └ <model_service.ModelService object at 0x158fb34d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x102e53e20>

> File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 13, in build_model
    df = prepare_data()
         └ <function prepare_data at 0x159071260>

  File "/Users/felipezarco/Documents/GitHub/MLE/preparation.py", line 10, in prepare_data
    data = load_data_from_db()
           └ <function load_data_from_db at 0x1684805e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/collection.py", line 17, in load_data_from_db
    return pd.read_sql(query, engine)
           │  │        │      └ Engine(sqlite:///db.sqlite)
           │  │        └ <sqlalchemy.sql.selectable.Select object at 0x168472270>
           │  └ <function read_sql at 0x15811b1a0>
           └ <module 'pandas' from '/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-package...

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           │          └ <function SQLDatabase.read_query at 0x15813cc20>
           └ <pandas.io.sql.SQLDatabase object at 0x168472510>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1848, in read_query
    result = self.execute(sql, params)
             │    │       │    └ None
             │    │       └ <sqlalchemy.sql.selectable.Select object at 0x168472270>
             │    └ <function SQLDatabase.execute at 0x15813ca40>
             └ <pandas.io.sql.SQLDatabase object at 0x168472510>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
           │    │   │       │     └ []
           │    │   │       └ <sqlalchemy.sql.selectable.Select object at 0x168472270>
           │    │   └ <function Connection.execute at 0x15f3fdb20>
           │    └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
           └ <pandas.io.sql.SQLDatabase object at 0x168472510>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x168472270>>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x15f3fde40>
           └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x15f3fe020>
          └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1840, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x15f3fe0c0>
           └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x15f3fe340>
    └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError('no such column: rent_apartments.construction_year')
          │                    │              └ (<class 'sqlite3.OperationalError'>, OperationalError('no such column: rent_apartments.construction_year'), <traceback object...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(sqlite3.OperationalError) no such column: rent_apartments.construction_year')
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x15f59cf40>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x15f31b230>
    └ <sqlalchemy.engine.base.Connection object at 0x1684727b0>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x102cdfbc0>

sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: rent_apartments.construction_year
[SQL: SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartments.bedrooms, rent_apartments.bathrooms, rent_apartments.balcony, rent_apartments.storage, rent_apartments.parking, rent_apartments.furnished, rent_apartments.garage, rent_apartments.garden, rent_apartments.energy, rent_apartments.facilities, rent_apartments.zip, rent_apartments.neighborhood, rent_apartments.rent 
FROM rent_apartments]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-03 16:33:45.439 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 16:33:45.439 | ERROR    | __main__:<module>:15 - An error has been caught in function '<module>', process 'MainProcess' (854), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 15, in <module>
    main()
    └ <function main at 0x102cc32e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x168480d60>
    └ <model_service.ModelService object at 0x158fb34d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x102e53e20>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 14, in build_model
    X,y = get_model_data(df)
          │              └ None
          └ <function get_model_data at 0x159070fe0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 35, in get_model_data
    X = data[IVs].copy()
        │    └ ['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
        └ None

TypeError: 'NoneType' object is not subscriptable
2025-08-03 16:38:26.680 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 16:38:26.680 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 16:38:26.680 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 16:38:26.680 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 16:38:26.680 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 16:38:26.685 | ERROR    | model:build_model:13 - An error has been caught in function 'build_model', process 'MainProcess' (1069), thread 'MainThread' (8404344960):
Traceback (most recent call last):

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x14f7a0ea0>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x14f61b230>
    └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x14e4ed640>

sqlite3.OperationalError: no such column: rent_apartments.construction_year


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x102fc9440>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x14fd64a40>
    └ <model_service.ModelService object at 0x14e43b4d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x103104540>

> File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 13, in build_model
    df = prepare_data()
         └ <function prepare_data at 0x14e4fd1c0>

  File "/Users/felipezarco/Documents/GitHub/MLE/preparation.py", line 10, in prepare_data
    data = load_data_from_db()
           └ <function load_data_from_db at 0x14fd642c0>

  File "/Users/felipezarco/Documents/GitHub/MLE/collection.py", line 17, in load_data_from_db
    return pd.read_sql(query, engine)
           │  │        │      └ Engine(sqlite:///db.sqlite)
           │  │        └ <sqlalchemy.sql.selectable.Select object at 0x14fd44ad0>
           │  └ <function read_sql at 0x14cdff1a0>
           └ <module 'pandas' from '/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-package...

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           │          └ <function SQLDatabase.read_query at 0x14ce20c20>
           └ <pandas.io.sql.SQLDatabase object at 0x14fd44d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1848, in read_query
    result = self.execute(sql, params)
             │    │       │    └ None
             │    │       └ <sqlalchemy.sql.selectable.Select object at 0x14fd44ad0>
             │    └ <function SQLDatabase.execute at 0x14ce20a40>
             └ <pandas.io.sql.SQLDatabase object at 0x14fd44d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
           │    │   │       │     └ []
           │    │   │       └ <sqlalchemy.sql.selectable.Select object at 0x14fd44ad0>
           │    │   └ <function Connection.execute at 0x14f6fda80>
           │    └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
           └ <pandas.io.sql.SQLDatabase object at 0x14fd44d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x14fd44ad0>>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x14f6fdda0>
           └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x14f6fdf80>
          └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1840, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x14f6fe020>
           └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x14f6fe2a0>
    └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError('no such column: rent_apartments.construction_year')
          │                    │              └ (<class 'sqlite3.OperationalError'>, OperationalError('no such column: rent_apartments.construction_year'), <traceback object...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(sqlite3.OperationalError) no such column: rent_apartments.construction_year')
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x14f7a0ea0>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x14f61b230>
    └ <sqlalchemy.engine.base.Connection object at 0x14fd45010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x14e4ed640>

sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: rent_apartments.construction_year
[SQL: SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartments.bedrooms, rent_apartments.bathrooms, rent_apartments.balcony, rent_apartments.storage, rent_apartments.parking, rent_apartments.furnished, rent_apartments.garage, rent_apartments.garden, rent_apartments.energy, rent_apartments.facilities, rent_apartments.zip, rent_apartments.neighborhood, rent_apartments.rent 
FROM rent_apartments]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-03 16:38:26.691 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 16:38:26.691 | ERROR    | __main__:<module>:16 - An error has been caught in function '<module>', process 'MainProcess' (1069), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x102fc9440>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x14fd64a40>
    └ <model_service.ModelService object at 0x14e43b4d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x103104540>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 14, in build_model
    X,y = get_model_data(df)
          │              └ None
          └ <function get_model_data at 0x14e4e3c40>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 35, in get_model_data
    X = data[IVs].copy()
        │    └ ['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
        └ None

TypeError: 'NoneType' object is not subscriptable
2025-08-03 16:50:49.576 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 16:50:49.576 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 16:50:49.576 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 16:50:49.576 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 16:50:49.576 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 16:50:49.584 | ERROR    | model:build_model:13 - An error has been caught in function 'build_model', process 'MainProcess' (1509), thread 'MainThread' (8404344960):
Traceback (most recent call last):

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x168ba0fe0>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x168a1b230>
    └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x104b6d3c0>

sqlite3.OperationalError: no such column: rent_apartments.construction_year


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x104c4d440>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x1692b8b80>
    └ <model_service.ModelService object at 0x157827620>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x104e0e160>

> File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 13, in build_model
    df = prepare_data()
         └ <function prepare_data at 0x1578e9260>

  File "/Users/felipezarco/Documents/GitHub/MLE/preparation.py", line 10, in prepare_data
    data = load_data_from_db()
           └ <function load_data_from_db at 0x1692b8400>

  File "/Users/felipezarco/Documents/GitHub/MLE/collection.py", line 17, in load_data_from_db
    return pd.read_sql(query, engine)
           │  │        │      └ Engine(sqlite:///db.sqlite)
           │  │        └ <sqlalchemy.sql.selectable.Select object at 0x169294ad0>
           │  └ <function read_sql at 0x1554ff240>
           └ <module 'pandas' from '/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-package...

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 736, in read_sql
    return pandas_sql.read_query(
           │          └ <function SQLDatabase.read_query at 0x155520cc0>
           └ <pandas.io.sql.SQLDatabase object at 0x169294d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1848, in read_query
    result = self.execute(sql, params)
             │    │       │    └ None
             │    │       └ <sqlalchemy.sql.selectable.Select object at 0x169294ad0>
             │    └ <function SQLDatabase.execute at 0x155520ae0>
             └ <pandas.io.sql.SQLDatabase object at 0x169294d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/io/sql.py", line 1672, in execute
    return self.con.execute(sql, *args)
           │    │   │       │     └ []
           │    │   │       └ <sqlalchemy.sql.selectable.Select object at 0x169294ad0>
           │    │   └ <function Connection.execute at 0x168afdbc0>
           │    └ <sqlalchemy.engine.base.Connection object at 0x169295010>
           └ <pandas.io.sql.SQLDatabase object at 0x169294d70>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.selectable.Select object at 0x169294ad0>>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x168afdee0>
           └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x168afe0c0>
          └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1840, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x168afe160>
           └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1980, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x168afe3e0>
    └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ OperationalError('no such column: rent_apartments.construction_year')
          │                    │              └ (<class 'sqlite3.OperationalError'>, OperationalError('no such column: rent_apartments.construction_year'), <traceback object...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ OperationalError('(sqlite3.OperationalError) no such column: rent_apartments.construction_year')
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1961, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x168ba0fe0>
    │    └ <sqlalchemy.dialects.sqlite.pysqlite.SQLiteDialect_pysqlite object at 0x168a1b230>
    └ <sqlalchemy.engine.base.Connection object at 0x169295010>
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ ()
    │      │       └ 'SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartme...
    │      └ <method 'execute' of 'sqlite3.Cursor' objects>
    └ <sqlite3.Cursor object at 0x104b6d3c0>

sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: rent_apartments.construction_year
[SQL: SELECT rent_apartments.address, rent_apartments.area, rent_apartments.construction_year, rent_apartments.rooms, rent_apartments.bedrooms, rent_apartments.bathrooms, rent_apartments.balcony, rent_apartments.storage, rent_apartments.parking, rent_apartments.furnished, rent_apartments.garage, rent_apartments.garden, rent_apartments.energy, rent_apartments.facilities, rent_apartments.zip, rent_apartments.neighborhood, rent_apartments.rent 
FROM rent_apartments]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-08-03 16:50:49.591 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 16:50:49.591 | ERROR    | __main__:<module>:16 - An error has been caught in function '<module>', process 'MainProcess' (1509), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x104c4d440>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x1692b8b80>
    └ <model_service.ModelService object at 0x157827620>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x104e0e160>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 14, in build_model
    X,y = get_model_data(df)
          │              └ None
          └ <function get_model_data at 0x1578e9080>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 35, in get_model_data
    X = data[IVs].copy()
        │    └ ['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
        └ None

TypeError: 'NoneType' object is not subscriptable
2025-08-03 16:58:06.536 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 16:58:06.536 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 16:58:06.536 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 16:58:06.536 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 16:58:06.536 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 16:58:06.553 | INFO     | preparation:encode_cat_cols:17 - encoding categorical columns ['balcony', 'storage', 'parking', 'furnished', 'garage']
2025-08-03 16:58:06.558 | INFO     | preparation:parse_garden_col:22 - adding garden info value
2025-08-03 16:58:06.718 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 16:58:06.718 | ERROR    | __main__:<module>:16 - An error has been caught in function '<module>', process 'MainProcess' (1649), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x1004ff2e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x14f464a40>
    └ <model_service.ModelService object at 0x14882b4d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x10068fe20>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 14, in build_model
    X,y = get_model_data(df)
          │              └                                        address   area  construction_year  ...  parking_yes  furnished_yes  garage_yes
          │                0     1...
          └ <function get_model_data at 0x1488d3c40>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 35, in get_model_data
    X = data[IVs].copy()
        │    └ ['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
        └                                        address   area  construction_year  ...  parking_yes  furnished_yes  garage_yes
          0     1...

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/core/frame.py", line 4113, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              │    │                           └ ['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes', 'parking_yes', 'furnished_yes', 'garage_yes', 'storage_yes']
              │    └ <pandas._libs.properties.AxisProperty object at 0x13b6fa6b0>
              └                                        address   area  construction_year  ...  parking_yes  furnished_yes  garage_yes
                0     1...
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    │    │                 │       │        └ 'columns'
    │    │                 │       └ array([ 1, -1,  4,  6, 12, 14, 15, 16, 13])
    │    │                 └ Index(['area', 'constraction_year', 'bedrooms', 'garden', 'balcony_yes',
    │    │                          'parking_yes', 'furnished_yes', 'garage_yes',...
    │    └ <function Index._raise_if_missing at 0x139b24860>
    └ Index(['address', 'area', 'construction_year', 'rooms', 'bedrooms',
             'bathrooms', 'garden', 'energy', 'facilities', 'zi...
  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
                      └ ['constraction_year']

KeyError: "['constraction_year'] not in index"
2025-08-03 17:05:55.012 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 17:05:55.012 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 17:05:55.012 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 17:05:55.012 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 17:05:55.012 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 17:05:55.030 | INFO     | preparation:encode_cat_cols:17 - encoding categorical columns ['balcony', 'storage', 'parking', 'furnished', 'garage']
2025-08-03 17:05:55.034 | INFO     | preparation:parse_garden_col:22 - adding garden info value
2025-08-03 17:05:55.193 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 17:05:55.194 | INFO     | model:split_train_test:40 - build train test datasets
2025-08-03 17:05:55.195 | INFO     | model:train_model:44 - Training randomforest regressor model
2025-08-03 17:07:43.068 | INFO     | model:evaluate_model:52 - evaluating model performance. SCORE=0.7748371848487615
2025-08-03 17:07:43.098 | ERROR    | __main__:<module>:16 - An error has been caught in function '<module>', process 'MainProcess' (1707), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x1024a72e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x167c64ae0>
    └ <model_service.ModelService object at 0x165a0b4d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x10266e200>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 19, in build_model
    save_model(model, name=model_name)
    │          │           └ 'rf_db_v1'
    │          └ RandomForestRegressor(max_depth=12, n_estimators=400)
    └ <function save_model at 0x167c649a0>

TypeError: save_model() got an unexpected keyword argument 'name'
2025-08-03 17:22:13.915 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 17:22:13.915 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 17:22:13.916 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 17:22:13.916 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 17:22:13.916 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 17:22:13.936 | INFO     | preparation:encode_cat_cols:17 - encoding categorical columns ['balcony', 'storage', 'parking', 'furnished', 'garage']
2025-08-03 17:22:13.943 | INFO     | preparation:parse_garden_col:22 - adding garden info value
2025-08-03 17:22:14.112 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 17:22:14.113 | INFO     | model:split_train_test:40 - build train test datasets
2025-08-03 17:22:14.115 | INFO     | model:train_model:44 - Training randomforest regressor model
2025-08-03 17:24:02.075 | INFO     | model:evaluate_model:52 - evaluating model performance. SCORE=0.7553693632391058
2025-08-03 17:24:02.098 | INFO     | model:save_model:56 - saving model to path: models
2025-08-03 17:24:02.098 | ERROR    | __main__:<module>:16 - An error has been caught in function '<module>', process 'MainProcess' (1839), thread 'MainThread' (8404344960):
Traceback (most recent call last):

> File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 16, in <module>
    main()
    └ <function main at 0x1030b32e0>

  File "/Users/felipezarco/Documents/GitHub/MLE/main.py", line 8, in main
    ml_svc.load_model()
    │      └ <function ModelService.load_model at 0x15ff64ae0>
    └ <model_service.ModelService object at 0x15e4e74d0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model_service.py", line 21, in load_model
    build_model(settings.model_name)
    │           │        └ 'rf_db_v1'
    │           └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    └ <function build_model at 0x1033e2200>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 19, in build_model
    save_model(model)
    │          └ RandomForestRegressor(max_depth=9, n_estimators=400)
    └ <function save_model at 0x15ff649a0>

  File "/Users/felipezarco/Documents/GitHub/MLE/model.py", line 57, in save_model
    pickle.dump(model, open(f'{settings.model_pth}/{settings.model_name}', 'wb'))
    │      │    │              │                    │        └ 'rf_db_v1'
    │      │    │              │                    └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    │      │    │              └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')
    │      │    └ RandomForestRegressor(max_depth=9, n_estimators=400)
    │      └ <built-in function dump>
    └ <module 'pickle' from '/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/pickle.py'>

  File "/Users/felipezarco/Library/Caches/pypoetry/virtualenvs/mle-JIVz_E_M-py3.13/lib/python3.13/site-packages/pydantic/main.py", line 991, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'model_pth'
                                 └ Settings(data_file_name='rent_apartments.csv', model_path='models', model_name='rf_db_v1', log_level='DEBUG')

AttributeError: 'Settings' object has no attribute 'model_pth'. Did you mean: 'model_path'?
2025-08-03 17:25:12.653 | INFO     | model_service:load_model:16 - Checking model exists
2025-08-03 17:25:12.654 | WARNING  | model_service:load_model:20 - Did not find existing model. Building new model
2025-08-03 17:25:12.654 | INFO     | model:build_model:12 - beginning model preprocessing of data
2025-08-03 17:25:12.654 | INFO     | preparation:prepare_data:9 - setting up preprocesing pipeline
2025-08-03 17:25:12.654 | INFO     | collection:load_data_from_db:15 - loading data table from database
2025-08-03 17:25:12.671 | INFO     | preparation:encode_cat_cols:17 - encoding categorical columns ['balcony', 'storage', 'parking', 'furnished', 'garage']
2025-08-03 17:25:12.675 | INFO     | preparation:parse_garden_col:22 - adding garden info value
2025-08-03 17:25:12.834 | INFO     | model:get_model_data:23 - load model related data
2025-08-03 17:25:12.835 | INFO     | model:split_train_test:40 - build train test datasets
2025-08-03 17:25:12.836 | INFO     | model:train_model:44 - Training randomforest regressor model
2025-08-03 17:27:01.876 | INFO     | model:evaluate_model:52 - evaluating model performance. SCORE=0.6198660930645633
2025-08-03 17:27:01.906 | INFO     | model:save_model:56 - saving model to path: models
2025-08-03 17:27:01.948 | INFO     | model_service:load_model:22 - Loading pickled model at models/rf_db_v1
2025-08-03 17:27:01.961 | INFO     | model_service:predict:26 - Predicting model with given inputs: [85, 2015, 2, 20, 1, 1, 0, 0, 1]
2025-08-03 17:27:01.975 | INFO     | __main__:main:12 - Predicted values from model object: [2026.72227458]
